easyblock = 'ConfigureMake'

name = 'Asio'
version = '1.22.1'

homepage = 'https://think-async.com/Asio/'

description = """Asio is a cross-platform C++ library for network and low-level I/O programming that provides
developers with a consistent asynchronous model using a modern C++ approach."""

toolchain = {'name': 'GCC', 'version': '10.3.0'}
toolchainopts = {'cstd': 'c++17'}

source_urls = [SOURCEFORGE_SOURCE]
sources = ['asio-%(version)s.tar.bz2']
patches = ['asio-%(version)s_remove_nonexistent_cpp20_example.patch']
checksums = [
    '6874d81a863d800ee53456b1cafcdd1abf38bbbf54ecf295056b053c0d7115ce',  # asio-1.22.1.tar.bz2
    # asio-1.22.1_remove_nonexistent_cpp20_example.patch
    '9e268ca4fb8e27f963420eae1ffdec38a9f3b3a15673c5e70ef1fef71261315d',
]

dependencies = [
    ('OpenSSL', '1.1', '', True),
    ('Boost', '1.76.0'),
]

configopts = '--with-boost=$BOOST_ROOT'
runtest = "check"

sanity_check_paths = {
    'files': ['include/asio.hpp'],
    'dirs': [],
}

moduleclass = 'lib'
